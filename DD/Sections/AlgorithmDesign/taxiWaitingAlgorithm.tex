\subsection{Waiting time}
This section describes the procedures the system uses to tell the users the remaining time before a taxi arrives or the remaining time before the arrival to the destination of a ride.
The calculations are made by the Google Maps API.

These APIs are used making HTTPS requests to \newline \emph{http://maps.googleapis.com/maps/api/directions/json}
with the following parameters:
\begin{itemize}
    \item origin: the current location of the user.
    \item destination: the destination point.
    \item departure\_time: the current time.
    \item traffic\_model: 'best\_guess'. This is the best estimate of travel time given what is known about both historical traffic conditions and live traffic. 
    \item mode: 'driving'
    \item key: API\_KEY. This is the application's API key, given by Google APIs Services.
\end{itemize}

Whenever a user is waiting for the arrival of a taxi or he is waiting to reach the destination, he can view the remaining time to the arrival.

\subparagraph{Case 1: remaining time to the taxi arrival}
In this case the user is waiting for the arrival of a taxi driver.
After he received the notification for his request acceptance, he can view the remaining time.
\begin{itemize}
    \item The device of the user makes a request to the CallManager telling it to calculate the remaining time.
    \item The CallManager makes a request to the Google Maps services requesting the data in JSON format.
    \item After receiving the JSON response, the CallManager sends it to the client device that will display it.
    \item Every minute the device redoes the request to the CallManager to get a new waiting time to display.
\end{itemize}

\subparagraph{Case 2: remaining time to the destination}
In this case the user wants to know when he will arrive to the destination during a taxi ride.
\begin{itemize}
    \item The device, when the user wishes to know, makes a request to the CallManager telling it to calculate the remaining time.
    \item The CallManager makes a request to the Google Maps services requesting the data in JSON format.
    \item After receiving the JSON response, the CallManager sends it to the client device that displays it in the request details page.
\end{itemize}

